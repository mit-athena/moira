%!PS-Adobe-2.0
%%Title: install.mss
%%DocumentFonts: (atend)
%%Creator: Mark A. Rosenstein,,E40-381M,31530,6616678 and Scribe 7(1700)
%%CreationDate: 21 May 1990 14:26
%%Pages: (atend)
%%EndComments
% PostScript Prelude for Scribe.
/BS {/SV save def 0.0 792.0 translate .01 -.01 scale} bind def
/ES {showpage SV restore} bind def
/SC {setrgbcolor} bind def
/FMTX matrix def
/RDF {WFT SLT 0.0 eq 
  {SSZ 0.0 0.0 SSZ neg 0.0 0.0 FMTX astore}
  {SSZ 0.0 SLT neg sin SLT cos div SSZ mul SSZ neg 0.0 0.0 FMTX astore}
  ifelse makefont setfont} bind def
/SLT 0.0 def
/SI { /SLT exch cvr def RDF} bind def
/WFT /Courier findfont def
/SF { /WFT exch findfont def RDF} bind def
/SSZ 1000.0 def
/SS { /SSZ exch 100.0 mul def RDF} bind def
/AF { /WFT exch findfont def /SSZ exch 100.0 mul def RDF} bind def
/MT /moveto load def
/XM {currentpoint exch pop moveto} bind def
/UL {gsave newpath moveto dup 2.0 div 0.0 exch rmoveto
   setlinewidth 0.0 rlineto stroke grestore} bind def
/LH {gsave newpath moveto setlinewidth
   0.0 rlineto
   gsave stroke grestore} bind def
/LV {gsave newpath moveto setlinewidth
   0.0 exch rlineto
   gsave stroke grestore} bind def
/BX {gsave newpath moveto setlinewidth
   exch
   dup 0.0 rlineto
   exch 0.0 exch neg rlineto
   neg 0.0 rlineto
   closepath
   gsave stroke grestore} bind def
/BX1 {grestore} bind def
/BX2 {setlinewidth 1 setgray stroke grestore} bind def
/PB {/PV save def newpath translate
    100.0 -100.0 scale pop /showpage {} def} bind def
/PE {PV restore} bind def
/GB {/PV save def newpath translate rotate
    div dup scale 100.0 -100.0 scale /showpage {} def} bind def
/GE {PV restore} bind def
/FB {dict dup /FontMapDict exch def begin} bind def
/FM {cvn exch cvn exch def} bind def
/FE {end /original-findfont /findfont load def  /findfont
   {dup FontMapDict exch known{FontMapDict exch get} if
   original-findfont} def} bind def
/BC {gsave moveto dup 0 exch rlineto exch 0 rlineto neg 0 exch rlineto closepath clip} bind def
/EC /grestore load def
/SH /show load def
/MX {exch show 0.0 rmoveto} bind def
/W {0 32 4 -1 roll widthshow} bind def
/WX {0 32 5 -1 roll widthshow 0.0 rmoveto} bind def
/RC {100.0 -100.0 scale
612.0 0.0 translate
-90.0 rotate
.01 -.01 scale} bind def
/URC {100.0 -100.0 scale
90.0 rotate
-612.0 0.0 translate
.01 -.01 scale} bind def
/RCC {100.0 -100.0 scale
0.0 -792.0 translate 90.0 rotate
.01 -.01 scale} bind def
/URCC {100.0 -100.0 scale
-90.0 rotate 0.0 792.0 translate
.01 -.01 scale} bind def
%%EndProlog
%%Page: 1 1
BS
0 SI
15 /Helvetica-Bold AF
13591 8294 MT
(Guidelines for Installing and Customizing Moira)SH
12 SS 
7200 10793 MT
(Requirements)SH
10 /Helvetica AF
7200 12313 MT
(This distribution has only)
112 W( been tested on Vaxen and IBM PC/RT's running 4.3 BSD, Decstation 3100's)111 W
7200 13833 MT
(running Ultrix 3.1, and Sun3's running SunOS 4.0.  It should)
18 W( run on other systems, but there are probably)19 W
7200 15353 MT
(some porting issues that have been missed.)SH
7200 18849 MT
(It requires:)SH
/Symbol SF
9242 20321 MT
(\267)SH
/Helvetica SF
9980 XM
(the Kerberos authentication system)SH
/Symbol SF
9242 22136 MT
(\267)SH
/Helvetica SF
9980 XM
(RTI Ingres, version 5.0 or later)SH
7200 23656 MT
(It can also make use of the zephyr notification system and hesiod nameservice.)SH
12 /Helvetica-Bold AF
7200 25642 MT
(Compiling the System)SH
10 /Helvetica AF
7200 27162 MT
(The makefiles should be complete.  If the file)14 W
/Helvetica-Oblique SF
27391 XM
(/usr/rtingres/bin/eqc)SH
/Helvetica SF
36464 XM
(exists when you make the system, both)14 W
7200 28682 MT
(the client and server programs will be built.  If that file does not exist, then only the client programs will be)16 W
7200 30202 MT
(built. This)
278 W( enables clients to be built for machines which do not have Ingres available.)SH
7200 33698 MT
(Some local configuration may be required.  First make any appropriate changes to)SH
/Helvetica-Oblique SF
43827 XM
(include/moira_site.h)SH
/Helvetica SF
(:)SH
9424 35099 MT
(1.)SH
/Helvetica-Bold SF
10536 XM
(MOIRA_SERVER)SH
/Helvetica SF
18895 XM
(is the default server to connect to.)
80 W( Note)
437 W( that clients will user command)79 W
10536 36242 MT
(line arguments, environment variables, and hesiod to find the server before falling back on)64 W
10536 37385 MT
(the compiled in default.)SH
9424 39200 MT
(2.)SH
10536 XM
(Define)SH
/Helvetica-Bold SF
13785 XM
(HESIOD)SH
/Helvetica SF
17978 XM
(here if you want)
81 W( to allow clients to use hesiod to find the Moira server.  If)80 W
10536 40343 MT
(you don't define)25 W
/Helvetica-Bold SF
17949 XM
(HESIOD)SH
/Helvetica SF
22087 XM
(and don't have a libhesiod.a on your system, put an empty library)26 W
10536 41486 MT
(with this name in lib/libhesiod.a.)SH
9424 43301 MT
(3.)SH
10536 XM
(Define)SH
/Helvetica-Bold SF
13772 XM
(ZEPHYR)SH
/Helvetica SF
18174 XM
(to have errors and status)
68 W( messages broadcast using zephyr.  If you don't)67 W
10536 44444 MT
(define)SH
/Helvetica-Bold SF
13575 XM
(ZEPHYR)SH
/Helvetica SF
17946 XM
(and don't have a libzephyr.a on your system, put an empty library with)
37 W( this)38 W
10536 45587 MT
(name in lib/libzephyr.a.)SH
9424 47402 MT
(4.)SH
10536 XM
(Define)SH
/Helvetica-Bold SF
13704 XM
(SYSLOG)SH
/Helvetica SF
18150 XM
(to have errors and status messages logged using syslog.)SH
9424 49217 MT
(5.)SH
10536 XM
(Undefine)SH
/Helvetica-Bold SF
14862 XM
(ATHENA)SH
/Helvetica SF
19352 XM
(unless you really want all of the local hacks we use.  Many parts)
46 W( of our)45 W
10536 50360 MT
(system have evolved and)
31 W( have various quirks for the sake of backwards compatibility.  You)32 W
10536 51503 MT
(probably don't need these.)SH
9424 53318 MT
(6.)SH
10536 XM
(Define)SH
/Helvetica-Bold SF
13835 XM
(INGRESVER)SH
/Helvetica SF
20134 XM
(to be the major version number of the Ingres release you are using)131 W
10536 54461 MT
(\050i.e. 4, 5, or 6\051.  This is)
89 W( used by some server code which attempts to work around certain)90 W
10536 55604 MT
(Ingres bugs.)SH
9424 57419 MT
(7.)SH
10536 XM
(At the)
7 W( end of the file are a number of defines of filenames and directories that the server will)6 W
10536 58562 MT
(use. These)
436 W( directories)
79 W( are referred to by name below.  You may change them to arrange)80 W
10536 59705 MT
(the disk usage on your Moira server differently.)SH
7200 61225 MT
(You may also need to edit)SH
/Helvetica-Oblique SF
19040 XM
(gen/nfs.sh)SH
/Helvetica SF
23932 XM
(to change the string)SH
/Helvetica-Bold SF
32993 XM
(MIT.EDU)SH
/Helvetica SF
37382 XM
(to match your local domain.)SH
7200 64721 MT
(First run a "make depend" in the top level directory, then "make all".)SH
ES
%%Page: 2 2
BS
0 SI
10 /Helvetica-Bold AF
30322 4329 MT
(2)SH
12 SS 
7200 8075 MT
(Installing Binaries)SH
10 /Helvetica AF
7200 9595 MT
(After building, a "make install" will)
5 W( put server-specific binaries in)4 W
/Helvetica-Oblique SF
35630 XM
(bin)SH
/Helvetica SF
37246 XM
(and the client binaries where we keep)4 W
7200 11115 MT
(them at Athena:)
255 W( user clients in)256 W
/Helvetica-Oblique SF
22463 XM
(${DESTDIR}/usr/athena)SH
/Helvetica SF
(, maintenance clients in)256 W
/Helvetica-Oblique SF
44830 XM
(${DESTDIR}/usr/etc)SH
/Helvetica SF
(,)SH
7200 12635 MT
(manual pages)
446 W( in)445 W
/Helvetica-Oblique SF
16151 XM
(${DESTDIR}/usr/man/man?)SH
/Helvetica SF
(, header files in)445 W
/Helvetica-Oblique SF
37272 XM
(${DESTDIR}/usr/include)SH
/Helvetica SF
(, libraries in)445 W
/Helvetica-Oblique SF
7200 14155 MT
(${DESTDIR}/usr/athena/lib)SH
/Helvetica SF
(, and)
255 W( lint libraries in)256 W
/Helvetica-Oblique SF
29265 XM
(${DESTDIR}/usr/athena/lib/lint)SH
/Helvetica SF
(. The)
790 W( include files and)256 W
7200 15675 MT
(libraries are so that users may compile their own moira clients without the rest of the source tree.)SH
7200 19171 MT
(Next the server machine must be set up.)SH
9424 20572 MT
(1.)SH
10536 XM
(Install Ingres)
223 W( on the machine, and configure)222 W
/Helvetica-Oblique SF
31768 XM
(/etc/rc)SH
/Helvetica SF
34991 XM
(so that it verifies the databases at)222 W
10536 21715 MT
(reboot. For)
278 W( example:)SH
10536 24001 MT
(if [ -f /usr/rtingres/bin/restoredb ]; then)SH
12760 25144 MT
(echo -n "Recovering Ingres databases..." >/dev/console)SH
12760 26287 MT
(/usr/rtingres/bin/restoredb -s -p)SH
12760 27430 MT
(echo "done." >/dev/console)SH
9424 29245 MT
(2.)SH
10536 XM
(Create this set of directories:)SH
8 SS 
17761 30500 MT
(1)SH
10 /Symbol AF
12578 30851 MT
(\267)SH
/Helvetica SF
13316 XM
(SMS_DIR)SH
/Symbol SF
12578 31994 MT
(\267)SH
/Helvetica SF
13316 XM
(BIN_DIR)SH
/Symbol SF
12578 33137 MT
(\267)SH
/Helvetica SF
13316 XM
(DCM_DIR)SH
/Symbol SF
12578 34280 MT
(\267)SH
/Helvetica SF
13316 XM
(LOCK_DIR)SH
/Symbol SF
12578 35423 MT
(\267)SH
/Helvetica SF
13316 XM
(DCM_DIR/hesiod, DCM_DIR/nfs)SH
10536 36824 MT
(Copy all of the binaries installed in)SH
/Helvetica-Oblique SF
25987 XM
(bin)SH
/Helvetica SF
27599 XM
(to BIN_DIR.)SH
7200 40320 MT
(Finally, make entries in /etc/services:)SH
/Courier SF
9600 41726 MT
(sms_db 775/tcp)
5400 W( #)
4800 W( Moira database)SH
9600 42757 MT
(sms_update 777/tcp)
3000 W( #)
4800 W( Moira update protocol)SH
9600 43788 MT
(sms_ureg 779/udp)
4200 W( #)
4800 W( Moira user registration)SH
/Helvetica SF
7200 45308 MT
(These are the numbers we use at Athena.  They are not officially allocated,)
23 W( and you may change them at)24 W
7200 46828 MT
(your site.)SH
12 /Helvetica-Bold AF
7200 48814 MT
(Creating the Database)SH
10 /Helvetica AF
7200 50334 MT
(Create an Ingres database called moira with the command "createdb sms".)SH
7200 53830 MT
(Run the script)SH
/Helvetica-Oblique SF
13647 XM
(db/newdb)SH
/Helvetica SF
18261 XM
(in quel, the Ingres query interpreter, creating a completely empty database.)SH
7200 57326 MT
(Run the)SH
/Helvetica-Oblique SF
10980 XM
(newmoira)SH
/Helvetica SF
15592 XM
(program to initialize the database.  This program will ask:)SH
9424 58727 MT
(1.)SH
10536 XM
(For the name of a user to be given access to the database.  Root will automatically be)
3 W( given)2 W
10536 59870 MT
(access; if you want someone else to be able to access the database through)
144 W( quel, then)145 W
10536 61013 MT
(enter their name\050s\051 here.  It will keep asking you for names until you enter an empty string.)SH
9424 62828 MT
(2.)SH
10536 XM
(The starting UID to assign.  This is the user)
59 W( id to be assigned to the next account created.)58 W
10536 63971 MT
(Each time an account is created, this number is incremented as long as it conflicts with)
59 W( an)60 W
10536 65114 MT
(existing UID in the database, then the resulting value is used.)SH
9424 66929 MT
(3.)SH
10536 XM
(The starting GID to assign.  This is used just like the UID above.)SH
10800 50 7200 70292 UL
6 SS 
8090 71687 MT
(1)SH
8 SS 
8424 72000 MT
(Directory names are as defined in)SH
/Helvetica-Oblique SF
20606 XM
(include/moira_site.h)SH
/Helvetica SF
(.)SH
ES
%%Page: 3 3
BS
0 SI
10 /Helvetica-Bold AF
30322 4329 MT
(3)SH
/Helvetica SF
9424 7929 MT
(4.)SH
10536 XM
(The default NFS quota.  This is the quota that new users are assigned.)SH
9424 9744 MT
(5.)SH
10536 XM
(The name of a privileged user.  This user will be put on the list dbadmin, which will be)
82 W( on)81 W
10536 10887 MT
(the access control list for every query.  This user may then make any change)
243 W( to the)244 W
10536 12030 MT
(database, including putting other users on the dbadmin list.)SH
7200 13550 MT
(At some point, the database must be optimized.  If a lot of)
142 W( data is to be added, wait until afterwards.)141 W
7200 15070 MT
(Otherwise, you)
140 W( may do the optimization now.  The script)141 W
/Helvetica-Oblique SF
33730 XM
(db/dbopt)SH
/Helvetica SF
38041 XM
(contains quel commands to modify)141 W
7200 16590 MT
(some of the structures and create additional indexes on the tables.  You should)
193 W( also run the ingres)192 W
7200 18110 MT
(commands)SH
/Helvetica-Oblique SF
12862 XM
(/usr/rtingres/bin/optimizedb)SH
/Helvetica SF
25638 XM
(and)SH
/Helvetica-Oblique SF
28078 XM
(/usr/rtingres/bin/sysmod)SH
/Helvetica SF
39464 XM
(after data is)
494 W( loaded into the)495 W
7200 19630 MT
(database.)SH
7200 23126 MT
(Make sure)
100 W( the necessary Kerberos keys are in your)99 W
/Helvetica-Oblique SF
31212 XM
(/etc/srvtab)SH
/Helvetica SF
36202 XM
(file on the server.  For the initial server)99 W
7200 24646 MT
(testing, only)58 W
/Helvetica-Bold SF
12930 XM
(moira.)SH
/Helvetica-Oblique SF
(machinename)SH
/Helvetica SF
(@)SH
/Helvetica-Oblique SF
(localrealm)SH
/Helvetica SF
28118 XM
(is needed,)
58 W( but)59 W
/Helvetica-Bold SF
34854 XM
(sms)SH
/Helvetica SF
(.[NULL]@)SH
/Helvetica-Oblique SF
(localrealm)SH
/Helvetica SF
46153 XM
(is needed as well)59 W
7200 26166 MT
(for updating servers, and)SH
/Helvetica-Bold SF
18539 XM
(register.)SH
/Helvetica-Oblique SF
(machinename)SH
/Helvetica SF
(@)SH
/Helvetica-Oblique SF
(localrealm)SH
/Helvetica SF
34614 XM
(is needed to run the registration service.)SH
12 /Helvetica-Bold AF
7200 28152 MT
(Testing the Services)SH
10 /Helvetica AF
7200 29672 MT
(At this)
15 W( point the server and clients may be tested.  Run BIN_DIR)14 W
/Helvetica-Oblique SF
(/startmoira)SH
/Helvetica SF
40841 XM
(to get a server running.  It will)14 W
7200 31192 MT
(log everything to SMS_DIR)89 W
/Helvetica-Oblique SF
(/moira.log)SH
/Helvetica SF
(. The)
456 W( privileged user chosen above may run the moira)
89 W( client, and)90 W
7200 32712 MT
(make changes to the database.  To make more privileged users, put the new users on the "dbadmin" list.)SH
7200 36208 MT
(When this much is satisfactory, then service extraction)
112 W( may be initialized.  Enable the desired services)111 W
7200 37728 MT
(from the)206 W
/Helvetica-Bold SF
11559 XM
(services)SH
/Helvetica SF
16047 XM
(sub-menu of the)207 W
/Helvetica-Bold SF
24172 XM
(dcm)SH
/Helvetica SF
26713 XM
(menu of the moira client.  Then run the DCM by invoking)207 W
7200 39248 MT
(BIN_DIR)SH
/Helvetica-Oblique SF
(/startdcm)SH
/Helvetica SF
(, and verify that it produces the)
38 W( desired file.  It will log messages to SMS_DIR)37 W
/Helvetica-Oblique SF
(/dcm.log)SH
/Helvetica SF
(.)SH
7200 40768 MT
(If the data files are OK, then you may)
58 W( enable automatic update to the other servers by making additions)59 W
7200 42288 MT
(in the)468 W
/Helvetica-Bold SF
10860 XM
(hosts)SH
/Helvetica SF
14273 XM
(sub-menu of the)468 W
/Helvetica-Bold SF
23181 XM
(dcm)SH
/Helvetica SF
25983 XM
(menu in the moira)
468 W( client.  Each host must be running)467 W
/Helvetica-Oblique SF
7200 43808 MT
(/usr/etc/update_server)SH
/Helvetica SF
17537 XM
(and have a Kerberos key for)110 W
/Helvetica-Bold SF
31037 XM
(rcmd)SH
/Helvetica SF
(.)SH
/Helvetica-Oblique SF
(hostname)SH
/Helvetica SF
(@)SH
/Helvetica-Oblique SF
(localrealm)SH
/Helvetica SF
44110 XM
(in its)110 W
/Helvetica-Oblique SF
46664 XM
(/etc/srvtab)SH
/Helvetica SF
51665 XM
(to be)111 W
7200 45328 MT
(able to receive updates.)SH
7200 48824 MT
(When service updates are satisfactory,)
48 W( you can set up)47 W
/Helvetica-Oblique SF
31916 XM
(/usr/lib/crontab)SH
/Helvetica SF
38799 XM
(to invoke BIN_DIR)47 W
/Helvetica-Oblique SF
(/startdcm)SH
/Helvetica SF
51555 XM
(every)SH
7200 50344 MT
(15 minutes.  When the DCM is started, it will determine what work there is to do.)SH
7200 53840 MT
(The only remaining part of the)
248 W( system is the registration server.  This may be invoked by starting)249 W
7200 55360 MT
(BIN_DIR)SH
/Helvetica-Oblique SF
(/startreg)SH
/Helvetica SF
(. Note)
458 W( that)
90 W( the registration client \050)89 W
/Helvetica-Oblique SF
(userreg)SH
/Helvetica SF
(\051 expects to find its data files in)89 W
/Helvetica-Oblique SF
48499 XM
(/mit/register)SH
/Helvetica SF
(.)SH
7200 56880 MT
(Before you can successfully register new accounts, you must have)SH
/Symbol SF
9242 58352 MT
(\267)SH
/Helvetica SF
9980 XM
(People entered as users in state 0)SH
/Symbol SF
9242 60167 MT
(\267)SH
/Helvetica SF
9980 XM
(1 or more)
45 W( hosts as POP service providers listed in the)46 W
/Helvetica-Bold SF
34604 XM
(hosts)SH
/Helvetica SF
37595 XM
(sub-menu of the)46 W
/Helvetica-Bold SF
45237 XM
(dcm)SH
/Helvetica SF
47617 XM
(menu in)46 W
9980 61310 MT
(the moira client.)69 W
/Helvetica-Oblique SF
17870 XM
(Value2)SH
/Helvetica SF
21330 XM
(for each of these is the)
69 W( maximum number of poboxes that may be)68 W
9980 62453 MT
(allocated on that server,)SH
/Helvetica-Oblique SF
20930 XM
(value1)SH
/Helvetica SF
24154 XM
(is the number currently allocated.)SH
/Symbol SF
9242 64268 MT
(\267)SH
/Helvetica SF
9980 XM
(1 or more NFS partitions listed in the)41 W
/Helvetica-Bold SF
26814 XM
(nfs)SH
/Helvetica SF
28633 XM
(menu of the moira client.  The declared)41 W
/Helvetica-Oblique SF
46580 XM
(size)SH
/Helvetica SF
48677 XM
(of the)41 W
9980 65411 MT
(partition must be greater than the sum)
90 W( of the quotas that will be assigned to it.  The status)89 W
9980 66554 MT
(must be "Student" for register to automatically assign new users there.)SH
/Symbol SF
9242 68369 MT
(\267)SH
/Helvetica-Bold SF
9980 XM
(register)SH
/Helvetica SF
(.)SH
/Helvetica-Oblique SF
(moiraserver)SH
/Helvetica SF
(@)SH
/Helvetica-Oblique SF
(localrealm)SH
/Helvetica SF
25135 XM
(must be on the "add" and "modify" access control lists)
82 W( for)83 W
9980 69512 MT
(the Kerberos admin server.)SH
ES
%%Page: 4 4
BS
0 SI
10 /Helvetica-Bold AF
30322 4329 MT
(4)SH
/Helvetica SF
7200 7929 MT
(When you are confident that the system works, you may have the daemons started by)31 W
/Helvetica-Oblique SF
45961 XM
(/etc/rc)SH
/Helvetica SF
(. We)
340 W( prefer)30 W
7200 9449 MT
(to start them)
64 W( by hand after verifying that the database survived any system crash.  We also have)65 W
/Helvetica-Oblique SF
51277 XM
(/etc/rc)SH
/Helvetica SF
7200 10969 MT
(create the file)25 W
/Helvetica-Oblique SF
13556 XM
(/etc/nodcm)SH
/Helvetica SF
18750 XM
(at boot time, so that the DCMs started every 15)
25 W( minutes won't do anything until)24 W
7200 12489 MT
(we removed that file.)SH
7200 15985 MT
(A final piece of configuration is regular backups.  We backup)
176 W( the database over the net, rather than)177 W
7200 17505 MT
(backing up the filesystem.  This allows us to restore the database on another machine architecture, if)139 W
7200 19025 MT
(necessary. We)
278 W( do this by having)SH
/Helvetica-Oblique SF
22151 XM
(cron)SH
/Helvetica SF
24374 XM
(run BIN_DIR)SH
/Helvetica-Oblique SF
(/nightly.sh)SH
/Helvetica SF
34822 XM
(at 5am each morning.)SH
12 /Helvetica-Bold AF
7200 21011 MT
(Customization)SH
10 /Helvetica AF
7200 22531 MT
(This is difficult to give advice on, but I'll start by describing how we add new services and change things.)SH
9424 23932 MT
(1.)SH
10536 XM
(First determine what data must be recorded for this service.  What is the type of)
191 W( each)192 W
10536 25075 MT
(datum: integer, string, date, username, listname, machinename, other?)SH
9424 26890 MT
(2.)SH
10536 XM
(Design the Ingres table to record this information.)
105 W( Integers)
487 W( may be 1, 2, or 4 bytes long.)104 W
10536 28033 MT
(Strings may be ascii)
69 W( character strings \050storage compresses out whitespace\051 or binary byte)70 W
10536 29176 MT
(fields. Other)
572 W( moira objects such as users, lists, machines, etc. should be referenced)
147 W( by)146 W
10536 30319 MT
(their internal ID numbers.  If you're creating a)
121 W( new type that may be referenced by other)122 W
10536 31462 MT
(tables, assign each object a)
282 W( unique ID number as well as its name.  Add this table)281 W
10536 32605 MT
(specification to)74 W
/Helvetica-Oblique SF
17576 XM
(db/newdb)SH
/Helvetica SF
(, so that recompiling the backup and restore programs will)
74 W( cause)75 W
10536 33748 MT
(them to know about the new table\050s\051.)SH
9424 35563 MT
(3.)SH
10536 XM
(If a new object type is added to the database, also update)111 W
/Helvetica-Oblique SF
37718 XM
(server/incremental.qc)SH
/Helvetica SF
47664 XM
(to know)110 W
10536 36706 MT
(about incremental updates to this type of object.)SH
9424 38521 MT
(4.)SH
10536 XM
(Specify the queries that will be used to access this data.  Most datatypes have)
90 W( 4 queries:)91 W
10536 39664 MT
(retrieve, add, update, and delete.)
133 W( Some)
543 W( have multiple kinds of retrieves, and/or multiple)132 W
10536 40807 MT
(kinds of updates.  If)
61 W( you make it similar to other existing queries, you are more likely to be)62 W
10536 41950 MT
(able to share code in the server.)SH
9424 43765 MT
(5.)SH
10536 XM
(Make the additional entries in)154 W
/Helvetica-Oblique SF
24590 XM
(server/queries2.c)SH
/Helvetica SF
32691 XM
(for the new queries.)
154 W( See)
585 W( the document)153 W
/Helvetica-Oblique SF
10536 44908 MT
(doc/server-internals)SH
/Helvetica SF
19721 XM
(for some idea of how the query table is coded.  Then recompile and)127 W
10536 46051 MT
(re-install the server.  You can test the new queries with the mrtest client.)SH
9424 47866 MT
(6.)SH
10536 XM
(It may be)
81 W( necessary to write a new dcm extraction program \050for many services, this is the)80 W
10536 49009 MT
(only thing)
97 W( required: no new data or queries\051.  The source to these is in the)98 W
/Helvetica-Oblique SF
45064 XM
(gen)SH
/Helvetica SF
47108 XM
(directory.)SH
10536 50152 MT
(Note that they touch the database directly, rather than going)
15 W( through the moira server.  This)14 W
10536 51295 MT
(is for performance reasons.  These routines use the queue and hash table)
7 W( routines from the)8 W
10536 52438 MT
(moira library.  The easiest way to write a new one that does all of the)
229 W( time checking)228 W
10536 53581 MT
(correctly is to start with one of the existing ones.)SH
ES
%%Trailer
%%Pages: 4
%%DocumentFonts: Helvetica Helvetica-Bold Symbol Helvetica-Oblique Courier
